[save_variables]
filename: ~/printer_data/config/variables.txt
[respond]
[include chopper_tune.cfg]
[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_02002A000151313433343333-if00

[printer]
kinematics: corexy
max_velocity: 500
max_accel: 20000
max_z_velocity: 75
max_z_accel: 2000
square_corner_velocity: 8
minimum_cruise_ratio: 0

[force_move]
enable_force_move: True

[gcode_arcs]
resolution: 0.1

[idle_timeout]
timeout: 3600
gcode:
    TURN_OFF_HEATERS
    M84
    LIGHTS_OFF
    M107

[include ./motors.cfg]
[include ./beacon.cfg]

#####################################################################
#   Extruder
#####################################################################

# MOTOR_3, HE3, T3
[extruder]
step_pin: PE6
dir_pin: !PA14
enable_pin: !PE0
rotation_distance: 21.818796675870694082451585948
gear_ratio: 50:6
microsteps: 16
full_steps_per_rotation: 200
nozzle_diameter: 0.400
filament_diameter: 1.75
heater_pin: PB11
sensor_type: PT1000
sensor_pin: PF7
pullup_resistor: 4700
min_temp: 10
max_temp: 350
max_power: 1.0
max_extrude_only_distance: 1400.0
max_extrude_only_velocity: 75.0
max_extrude_only_accel: 1500
min_extrude_temp: 10
pressure_advance: 0.015
pressure_advance_smooth_time: 0.02
pwm_cycle_time: 0.010

heater_power: 120
cooling_fan: fan
ambient_temp_sensor: temperature_sensor beacon_coil
filament_density: 1.20
filament_heat_capacity: 1.8

[tmc2209 extruder]
uart_pin: PD3
interpolate: false
run_current: 0.7
sense_resistor: 0.110
stealthchop_threshold: 0
driver_TBL: 0
driver_TOFF: 3
driver_HSTRT: 7
driver_HEND: 5

[verify_heater extruder]
hysteresis: 10
check_gain_time: 40
heating_gain: 2
max_error: 500

#####################################################################
#   Bed Heater
#####################################################################

#  HE2, T2
[heater_bed]
heater_pin: PB0
sensor_type: Generic 3950
sensor_pin: PF6
max_power: 1.0
min_temp: 0
max_temp: 120
pwm_cycle_time: 0.01667

#####################################################################
#   Chamber Heater
#####################################################################

#  HE2, T1, MAX31865

[heater_generic chamber]
sensor_type: PT1000
sensor_pin: PF3

min_temp: 0
max_temp: 350

gcode_id: C
heater_pin: PA2

control: pid
pid_Kp: 70.184
pid_Ki: 0.376
pid_Kd: 3274.071

[verify_heater chamber]
max_error: 500 # double if needed
check_gain_time: 600 #default for extruder is 20, 60 for bed heater. increase for weak heaters. 
hysteresis: 15 #default is 5, this is the maximum allowable deviation from setpoint. increase during PID tuning. 
heating_gain:2 #default is 2. increase this for very fast heaters, decrease this for weak ones.

#  T1
[temperature_sensor heater_core]
sensor_pin: PF5
sensor_type: PT1000

#####################################################################
#   Fan Control
#####################################################################

# FAN4
[fan]
pin: PD14
kick_start_time: 0.5
shutdown_speed: 0.0
hardware_pwm: false
cycle_time: 0.0001

# FAN5
[heater_fan hotend_fan]
pin: PD15
max_power: 1.0
kick_start_time: 0.5
heater: extruder
heater_temp: 50.0
shutdown_speed: 1.0

# FAN3
[heater_fan bed_fan]
pin: PD13
max_power: 1.0
kick_start_time: 0.5
heater: heater_bed
heater_temp: 110.0
shutdown_speed: 0.0

# FAN2
[controller_fan controller_fan]
pin: !PD12
max_power: 1.0
fan_speed: 1.0
kick_start_time: 0.1
heater: extruder,heater_bed
shutdown_speed: 1.0
cycle_time: 0.00004
hardware_pwm: True

# FAN1
[heater_fan chamber_fan]
pin: PE5
max_power: 1.0
kick_start_time: 0.5
heater: chamber
heater_temp: 50.0
shutdown_speed: 0

#####################################################################
#   LED Control
#####################################################################

# HE1
[output_pin chamber_light]
pin: PA3
pwm: true
shutdown_value: 0
value: 0.0
hardware_pwm: false
cycle_time: 0.0005

[include ./input_shaper.cfg]
[include ./fluidd.cfg]
[include ./macros/macros.cfg]
[skew_correction]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = mpc
#*# block_heat_capacity = 30.7120
#*# sensor_responsiveness = 0.102444
#*# ambient_transfer = 0.146235
#*# fan_ambient_transfer = 0.146235, 0.222049, 0.295032
#*#
#*# [heater_bed]
#*# control = pid
#*# block_heat_capacity = 913.098
#*# sensor_responsiveness = 0.0169211
#*# ambient_transfer = 6.86391
#*# fan_ambient_transfer =
#*# pid_version = 1
#*# pid_target = 110.00
#*# pid_tolerance = 0.0200
#*# pid_kp = 53.495
#*# pid_ki = 2.048
#*# pid_kd = 349.390
#*#
#*# [beacon model default]
#*# model_coef = 1.487246033859419,
#*# 	1.8380350163247583,
#*# 	0.7261806813063939,
#*# 	0.2125164084276451,
#*# 	0.5661583723946509,
#*# 	0.9113044123101082,
#*# 	-0.4967419850895703,
#*# 	-1.1099234347549913,
#*# 	0.31714550305371425,
#*# 	0.5522135723685144
#*# model_domain = 1.8393064752383347e-07,1.9307988933589706e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 81.487791
#*# model_offset = 0.00000
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.038932, -0.046767, -0.051370, -0.055779, -0.060198, -0.058786, -0.057050, -0.053022, -0.049237, -0.041384, -0.030826, -0.019778, -0.013840, -0.011927, -0.010688, -0.012253, -0.014677, -0.017140, -0.016640, -0.019349, -0.021534, -0.026649, -0.030364, -0.036435, -0.038551
#*# 	-0.044838, -0.055794, -0.059731, -0.066645, -0.066498, -0.065439, -0.062356, -0.055664, -0.050746, -0.043823, -0.029843, -0.018373, -0.010391, -0.007032, -0.007747, -0.010531, -0.012461, -0.012222, -0.012547, -0.017385, -0.022178, -0.026906, -0.034185, -0.034772, -0.031869
#*# 	-0.050751, -0.058050, -0.065322, -0.066319, -0.069828, -0.068215, -0.065541, -0.059492, -0.053461, -0.046314, -0.037389, -0.022318, -0.013879, -0.007362, -0.007304, -0.007337, -0.009711, -0.011740, -0.011631, -0.014065, -0.017997, -0.022433, -0.027298, -0.031984, -0.029954
#*# 	-0.052619, -0.063932, -0.064153, -0.069877, -0.068273, -0.069936, -0.067345, -0.061059, -0.056220, -0.052866, -0.045905, -0.030939, -0.019139, -0.013261, -0.008285, -0.006936, -0.005650, -0.005289, -0.005884, -0.007887, -0.010825, -0.016497, -0.023029, -0.023399, -0.020990
#*# 	-0.051004, -0.059708, -0.065071, -0.066925, -0.068708, -0.070756, -0.071129, -0.066822, -0.062992, -0.058354, -0.051432, -0.039989, -0.028028, -0.018262, -0.011004, -0.006880, -0.004308, -0.004243, -0.004951, -0.005500, -0.006501, -0.010561, -0.014614, -0.019911, -0.019611
#*# 	-0.047635, -0.059682, -0.063571, -0.069184, -0.068155, -0.066832, -0.066776, -0.065254, -0.063260, -0.058935, -0.053615, -0.042838, -0.031463, -0.020935, -0.012531, -0.006394, -0.002044, -0.000154, -0.001153, -0.001213, -0.004748, -0.008842, -0.014312, -0.012419, -0.009889
#*# 	-0.049175, -0.055156, -0.061892, -0.062761, -0.063829, -0.062678, -0.060821, -0.058783, -0.058717, -0.055966, -0.050070, -0.041848, -0.029462, -0.016403, -0.008028, -0.002945, -0.000105, 0.001139, -0.000581, 0.000464, 0.000094, -0.003296, -0.004590, -0.007131, -0.005404
#*# 	-0.046421, -0.056234, -0.057226, -0.063317, -0.059949, -0.055867, -0.052846, -0.052854, -0.051510, -0.051642, -0.046579, -0.036756, -0.026109, -0.014994, -0.006058, -0.001328, 0.002199, 0.005087, 0.005295, 0.004802, 0.002711, -0.000720, -0.004625, -0.000560, 0.003601
#*# 	-0.045793, -0.050786, -0.056559, -0.057562, -0.057860, -0.054205, -0.050524, -0.049435, -0.050164, -0.046381, -0.043132, -0.034317, -0.022542, -0.011847, -0.004862, 0.001101, 0.004130, 0.003544, 0.006785, 0.006133, 0.004491, 0.004822, 0.005223, 0.004379, 0.006667
#*# 	-0.044241, -0.049977, -0.054110, -0.058925, -0.053921, -0.046722, -0.044108, -0.043838, -0.042375, -0.042004, -0.037314, -0.028932, -0.019019, -0.009857, -0.001868, 0.004410, 0.006671, 0.010645, 0.010818, 0.008785, 0.009260, 0.010167, 0.010208, 0.012845, 0.017003
#*# 	-0.042504, -0.047462, -0.052962, -0.054442, -0.048933, -0.041949, -0.035958, -0.035569, -0.038126, -0.038042, -0.033215, -0.024798, -0.016798, -0.007663, -0.000355, 0.006876, 0.010755, 0.013010, 0.014094, 0.012668, 0.015314, 0.015125, 0.020374, 0.021374, 0.025546
#*# 	-0.038935, -0.043151, -0.047116, -0.051017, -0.046699, -0.037807, -0.033069, -0.031261, -0.033531, -0.033379, -0.029363, -0.022142, -0.015012, -0.006764, 0.000552, 0.006546, 0.011679, 0.014582, 0.015461, 0.016824, 0.019102, 0.024326, 0.027403, 0.031570, 0.032974
#*# 	-0.034849, -0.038653, -0.044742, -0.044291, -0.042277, -0.037096, -0.031306, -0.030172, -0.032708, -0.029892, -0.025818, -0.020641, -0.012880, -0.005268, 0.000153, 0.006491, 0.012493, 0.014811, 0.016795, 0.019717, 0.023099, 0.029096, 0.036136, 0.037224, 0.039495
#*# 	-0.033479, -0.037652, -0.041487, -0.045065, -0.041449, -0.036034, -0.032469, -0.032078, -0.030037, -0.027395, -0.022958, -0.016593, -0.009894, -0.003703, 0.000678, 0.005877, 0.010856, 0.016288, 0.019200, 0.019866, 0.025087, 0.031531, 0.033846, 0.036660, 0.037491
#*# 	-0.034781, -0.035971, -0.041565, -0.043669, -0.042256, -0.036102, -0.034994, -0.030369, -0.028400, -0.024487, -0.019594, -0.012492, -0.007370, -0.002423, 0.004237, 0.009186, 0.013157, 0.016528, 0.019396, 0.022062, 0.025428, 0.028004, 0.031059, 0.031776, 0.032919
#*# 	-0.032514, -0.038970, -0.039445, -0.043492, -0.043296, -0.039397, -0.034512, -0.030439, -0.024784, -0.019376, -0.014820, -0.008268, -0.002045, 0.002059, 0.007680, 0.014079, 0.016063, 0.020554, 0.023639, 0.023629, 0.026086, 0.027483, 0.025893, 0.027583, 0.029303
#*# 	-0.028129, -0.033059, -0.038949, -0.040129, -0.040710, -0.037340, -0.033357, -0.025821, -0.019478, -0.014645, -0.009768, -0.004188, 0.001748, 0.007636, 0.011658, 0.016107, 0.020337, 0.025398, 0.028723, 0.030205, 0.029921, 0.026941, 0.024899, 0.024319, 0.028059
#*# 	-0.023136, -0.028971, -0.030208, -0.035641, -0.035551, -0.033352, -0.029812, -0.025386, -0.017193, -0.012070, -0.006311, 0.000560, 0.004441, 0.008765, 0.014891, 0.018941, 0.021487, 0.027502, 0.029736, 0.033290, 0.034896, 0.032918, 0.026645, 0.025076, 0.025663
#*# 	-0.016977, -0.025841, -0.031723, -0.033187, -0.032700, -0.030237, -0.028100, -0.024622, -0.019177, -0.013867, -0.007478, -0.001629, 0.002243, 0.006632, 0.010914, 0.015765, 0.020793, 0.026640, 0.033538, 0.036795, 0.034237, 0.028145, 0.023894, 0.020337, 0.023335
#*# 	-0.022636, -0.028266, -0.031193, -0.037054, -0.036031, -0.036557, -0.034607, -0.032228, -0.027357, -0.020413, -0.016335, -0.010371, -0.005609, -0.001943, 0.003667, 0.007449, 0.013599, 0.019644, 0.024487, 0.027103, 0.026611, 0.023464, 0.016192, 0.013151, 0.011935
#*# 	-0.023172, -0.030309, -0.039689, -0.042724, -0.043404, -0.043487, -0.041048, -0.037578, -0.033174, -0.028457, -0.024329, -0.019156, -0.015078, -0.011011, -0.005839, 0.000724, 0.008917, 0.015075, 0.019253, 0.018357, 0.012978, 0.005814, 0.002522, 0.000551, 0.005355
#*# 	-0.027686, -0.034000, -0.037271, -0.045456, -0.048496, -0.049950, -0.049194, -0.045305, -0.038768, -0.033353, -0.030867, -0.026622, -0.022221, -0.016342, -0.010348, -0.003354, 0.001188, 0.006274, 0.007470, 0.005211, 0.002868, 0.000147, -0.004331, -0.005641, -0.006485
#*# 	-0.023727, -0.034258, -0.043596, -0.048131, -0.052470, -0.053445, -0.052008, -0.047908, -0.043314, -0.038118, -0.034920, -0.029926, -0.025282, -0.020604, -0.015220, -0.008726, -0.001057, 0.001945, 0.003239, 0.000504, -0.005270, -0.012471, -0.013687, -0.015216, -0.011726
#*# 	-0.021577, -0.029526, -0.036159, -0.045340, -0.050901, -0.054939, -0.054257, -0.049676, -0.043755, -0.038044, -0.034290, -0.030468, -0.025360, -0.018224, -0.013247, -0.007464, -0.004399, -0.002235, -0.005319, -0.006552, -0.007097, -0.008804, -0.011581, -0.015522, -0.018038
#*# 	-0.013288, -0.024862, -0.037567, -0.045773, -0.049223, -0.050058, -0.050814, -0.046386, -0.043629, -0.039016, -0.035076, -0.030117, -0.024411, -0.018811, -0.013385, -0.006928, -0.005620, -0.004915, -0.005501, -0.009291, -0.011817, -0.012454, -0.016445, -0.020387, -0.020775
#*# x_count = 25
#*# y_count = 25
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.2
#*# min_x = 30.0
#*# max_x = 205.0
#*# min_y = 30.0
#*# max_y = 210.0
#*#
#*# [skew_correction Califlower]
#*# xy_skew = -0.00040044160245974287
#*# xz_skew = 0.0
#*# yz_skew = 0.0
