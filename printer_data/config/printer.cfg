[save_variables]
filename: ~/printer_data/config/variables.txt
[respond]
[include chopper_tune.cfg]
[skew_correction]
[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_02002A000151313433343333-if00

[printer]
kinematics: corexy
max_velocity: 500
max_accel: 20000
max_z_velocity: 75
max_z_accel: 2000
square_corner_velocity: 8
minimum_cruise_ratio: 0

[force_move]
enable_force_move: True

[gcode_arcs]
resolution: 0.1

[idle_timeout]
timeout: 3600
gcode:
    TURN_OFF_HEATERS
    M84
    LIGHTS_OFF
    M107

[include ./motors.cfg]
[include ./beacon.cfg]

#####################################################################
#   Extruder
#####################################################################

# MOTOR_3, HE3, T3
[extruder]
step_pin: PE6
dir_pin: !PA14
enable_pin: !PE0
rotation_distance: 21.818796675870694082451585948
gear_ratio: 50:6
microsteps: 16
full_steps_per_rotation: 200
nozzle_diameter: 0.400
filament_diameter: 1.75
heater_pin: PB11
sensor_type: PT1000
sensor_pin: PF7
pullup_resistor: 4700
min_temp: 10
max_temp: 350
max_power: 1.0
max_extrude_only_distance: 1400.0
max_extrude_only_velocity: 75.0
max_extrude_only_accel: 1500
max_extrude_cross_section: 5
min_extrude_temp: 10
pressure_advance: 0.015
pressure_advance_smooth_time: 0.02
pwm_cycle_time: 0.010

heater_power: 120
cooling_fan: fan
ambient_temp_sensor: temperature_sensor beacon_coil
filament_density: 1.20
filament_heat_capacity: 1.8

[tmc2209 extruder]
uart_pin: PD3
interpolate: false
run_current: 0.7
sense_resistor: 0.110
stealthchop_threshold: 0
driver_TBL: 0
driver_TOFF: 3
driver_HSTRT: 7
driver_HEND: 5

[verify_heater extruder]
hysteresis: 10
check_gain_time: 40
heating_gain: 2
max_error: 500

#####################################################################
#   Bed Heater
#####################################################################

#  HE2, T2
[heater_bed]
heater_pin: PB0
sensor_type: Generic 3950
sensor_pin: PF6
max_power: 1.0
min_temp: 0
max_temp: 120
pwm_cycle_time: 0.01667

#####################################################################
#   Chamber Heater
#####################################################################

#  HE2, T1, MAX31865

[heater_generic chamber]
sensor_type: PT1000
sensor_pin: PF3

min_temp: 0
max_temp: 350

gcode_id: C
heater_pin: PA0

control: pid
pid_Kp: 70.184
pid_Ki: 0.376
pid_Kd: 3274.071

[verify_heater chamber]
max_error: 500 # double if needed
check_gain_time: 600 #default for extruder is 20, 60 for bed heater. increase for weak heaters. 
hysteresis: 15 #default is 5, this is the maximum allowable deviation from setpoint. increase during PID tuning. 
heating_gain:2 #default is 2. increase this for very fast heaters, decrease this for weak ones.

#  T1
[temperature_sensor heater_core]
sensor_pin: PF5
sensor_type: PT1000

#####################################################################
#   Fan Control
#####################################################################

# FAN4
[fan]
pin: PD14
kick_start_time: 0.5
shutdown_speed: 0.0
hardware_pwm: false
cycle_time: 0.0001

# FAN5
[heater_fan hotend_fan]
pin: PD15
max_power: 1.0
kick_start_time: 0.5
heater: extruder
heater_temp: 50.0
shutdown_speed: 1.0

# FAN3
[heater_fan bed_fan]
pin: PD13
max_power: 1.0
kick_start_time: 0.5
heater: heater_bed
heater_temp: 110.0
shutdown_speed: 0.0

# FAN2
[controller_fan controller_fan]
pin: !PD12
max_power: 1.0
fan_speed: 1.0
kick_start_time: 0.1
heater: extruder,heater_bed
shutdown_speed: 1.0
cycle_time: 0.00004
hardware_pwm: True

# FAN1
[heater_fan chamber_fan]
pin: PE5
max_power: 1.0
kick_start_time: 0.5
heater: chamber
heater_temp: 70.0
shutdown_speed: 1.0
tachometer_pin: PG15
tachometer_ppr: 1
tachometer_poll_interval: 0.0015

#####################################################################
#   LED Control
#####################################################################

# HE1
[output_pin chamber_light]
pin: PA3
pwm: true
shutdown_value: 0
value: 0.0
hardware_pwm: false
cycle_time: 0.0005

[include ./input_shaper.cfg]
[include ./fluidd.cfg]
[include ./macros/macros.cfg]
[include KAMP_Settings.cfg]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = mpc
#*# block_heat_capacity = 30.7120
#*# sensor_responsiveness = 0.102444
#*# ambient_transfer = 0.146235
#*# fan_ambient_transfer = 0.146235, 0.222049, 0.295032
#*#
#*# [heater_bed]
#*# control = pid
#*# block_heat_capacity = 913.098
#*# sensor_responsiveness = 0.0169211
#*# ambient_transfer = 6.86391
#*# fan_ambient_transfer =
#*# pid_version = 1
#*# pid_target = 110.00
#*# pid_tolerance = 0.0200
#*# pid_kp = 53.495
#*# pid_ki = 2.048
#*# pid_kd = 349.390
#*#
#*# [beacon model default]
#*# model_coef = 1.4716949649366866,
#*# 	  1.8166720492096156,
#*# 	  0.7595622127127389,
#*# 	  0.2540382392010495,
#*# 	  0.3340748117256274,
#*# 	  0.5773516000809598,
#*# 	  -0.1813089907931199,
#*# 	  -0.587253199240883,
#*# 	  0.21616520788359495,
#*# 	  0.3412897013783214
#*# model_domain = 1.8330825474745873e-07,1.9312089594602364e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 83.064142
#*# model_offset = 0.00000
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  -0.019014, -0.027091, -0.030308, -0.033828, -0.036166, -0.038576, -0.037975, -0.034805, -0.029072, -0.021258, -0.015544, -0.006688, -0.000225, 0.006238, 0.009520, 0.012757, 0.012571, 0.012065, 0.013034, 0.014923, 0.014603, 0.011957, 0.010861, 0.009601, 0.010255
#*# 	  -0.025554, -0.034858, -0.040054, -0.042182, -0.043888, -0.043024, -0.041504, -0.038424, -0.034440, -0.025863, -0.020300, -0.010879, -0.002979, 0.003460, 0.007502, 0.012290, 0.013944, 0.016938, 0.016304, 0.014678, 0.013696, 0.013564, 0.015505, 0.016195, 0.020912
#*# 	  -0.027390, -0.038147, -0.044724, -0.049038, -0.050476, -0.048450, -0.045360, -0.042023, -0.038804, -0.031822, -0.023573, -0.013862, -0.007047, 0.000276, 0.005213, 0.011251, 0.015362, 0.017863, 0.018398, 0.016688, 0.015162, 0.013307, 0.014853, 0.018764, 0.023770
#*# 	  -0.037246, -0.041052, -0.045287, -0.051524, -0.054808, -0.054571, -0.052507, -0.047497, -0.040479, -0.034648, -0.025803, -0.016751, -0.007019, -0.001582, 0.006334, 0.010434, 0.013772, 0.016360, 0.019422, 0.020816, 0.021308, 0.019194, 0.015161, 0.015856, 0.019448
#*# 	  -0.041037, -0.045142, -0.047935, -0.051191, -0.054026, -0.055669, -0.053273, -0.048966, -0.042444, -0.034321, -0.026543, -0.018124, -0.009024, -0.000664, 0.007260, 0.013425, 0.016584, 0.018900, 0.019320, 0.021348, 0.023996, 0.025798, 0.025131, 0.024431, 0.024989
#*# 	  -0.042963, -0.049325, -0.051686, -0.051306, -0.051288, -0.052014, -0.050645, -0.048104, -0.043089, -0.035125, -0.026362, -0.017813, -0.008848, -0.000523, 0.006405, 0.014413, 0.019962, 0.020994, 0.022685, 0.024640, 0.026393, 0.027771, 0.029613, 0.032090, 0.033690
#*# 	  -0.036739, -0.043046, -0.047517, -0.052474, -0.054887, -0.054638, -0.049554, -0.045501, -0.039586, -0.033603, -0.026909, -0.018092, -0.008805, -0.000328, 0.005954, 0.011799, 0.018779, 0.024676, 0.029047, 0.031362, 0.029896, 0.027737, 0.027863, 0.031494, 0.041160
#*# 	  -0.036549, -0.041247, -0.046729, -0.051134, -0.051818, -0.049876, -0.046430, -0.041204, -0.038339, -0.032780, -0.024590, -0.017761, -0.009674, -0.001517, 0.005746, 0.012117, 0.019460, 0.025627, 0.029087, 0.032029, 0.031341, 0.031094, 0.033086, 0.038329, 0.046331
#*# 	  -0.039039, -0.043737, -0.046049, -0.045486, -0.043777, -0.043090, -0.042197, -0.041353, -0.038068, -0.031113, -0.024137, -0.016971, -0.009376, -0.002548, 0.006693, 0.013700, 0.020731, 0.023710, 0.027530, 0.029836, 0.034048, 0.039606, 0.044523, 0.046637, 0.048192
#*# 	  -0.033258, -0.036170, -0.037730, -0.037431, -0.039928, -0.041422, -0.041501, -0.038762, -0.034355, -0.027694, -0.021050, -0.014462, -0.008299, -0.000141, 0.007516, 0.014892, 0.020682, 0.024308, 0.028412, 0.035009, 0.041195, 0.046218, 0.049091, 0.048743, 0.049227
#*# 	  -0.022099, -0.026431, -0.030303, -0.034740, -0.037803, -0.037718, -0.035259, -0.031414, -0.029179, -0.024001, -0.018186, -0.011359, -0.004765, 0.003078, 0.009231, 0.015695, 0.022090, 0.029716, 0.036670, 0.044500, 0.049076, 0.051069, 0.050703, 0.051938, 0.058005
#*# 	  -0.015205, -0.022562, -0.028725, -0.031926, -0.032514, -0.029643, -0.028275, -0.027079, -0.023840, -0.020122, -0.015391, -0.007938, -0.001245, 0.005452, 0.012475, 0.019677, 0.026852, 0.035241, 0.041850, 0.046995, 0.050650, 0.053629, 0.059248, 0.065438, 0.071684
#*# 	  -0.012704, -0.022683, -0.024605, -0.026102, -0.025347, -0.025723, -0.022118, -0.020793, -0.017779, -0.014826, -0.008944, -0.003085, 0.002045, 0.008909, 0.017059, 0.024780, 0.032838, 0.041025, 0.046129, 0.051294, 0.058121, 0.062477, 0.068898, 0.074292, 0.077560
#*# 	  -0.012350, -0.013581, -0.017572, -0.020023, -0.022305, -0.023955, -0.021354, -0.018714, -0.014549, -0.009627, -0.004791, 0.000185, 0.007148, 0.014852, 0.021017, 0.028072, 0.035328, 0.043756, 0.051112, 0.062522, 0.068924, 0.071657, 0.072209, 0.070731, 0.071765
#*# 	  -0.009336, -0.011013, -0.013420, -0.015422, -0.018910, -0.020234, -0.017391, -0.014525, -0.009736, -0.005768, -0.001045, 0.005288, 0.011864, 0.019021, 0.027182, 0.034056, 0.040095, 0.048639, 0.055043, 0.064225, 0.070631, 0.073688, 0.073818, 0.074144, 0.074493
#*# 	  -0.008647, -0.014900, -0.018739, -0.017769, -0.015110, -0.012641, -0.011951, -0.009898, -0.008075, -0.002833, 0.003063, 0.009196, 0.015334, 0.022155, 0.029689, 0.038131, 0.048357, 0.054859, 0.059468, 0.064809, 0.068071, 0.071423, 0.075917, 0.078784, 0.080078
#*# 	  -0.005107, -0.009933, -0.016272, -0.016210, -0.016927, -0.013575, -0.009501, -0.007062, -0.004251, 0.001042, 0.007121, 0.012461, 0.019808, 0.026385, 0.033329, 0.041263, 0.050162, 0.058568, 0.066330, 0.069341, 0.069552, 0.069483, 0.069758, 0.075466, 0.079139
#*# 	  -0.005144, -0.009463, -0.011707, -0.014441, -0.016857, -0.014296, -0.010794, -0.004692, -0.001852, 0.002717, 0.008700, 0.015597, 0.022794, 0.030445, 0.036381, 0.042766, 0.050473, 0.060405, 0.067614, 0.072445, 0.073140, 0.069511, 0.067098, 0.066045, 0.068859
#*# 	  -0.009711, -0.013310, -0.012438, -0.013866, -0.012825, -0.012932, -0.010848, -0.007899, -0.003055, 0.001671, 0.007810, 0.014209, 0.022608, 0.030346, 0.037263, 0.043863, 0.052377, 0.059123, 0.063032, 0.067373, 0.068056, 0.069176, 0.067103, 0.064385, 0.062336
#*# 	  -0.006608, -0.011518, -0.013788, -0.016072, -0.016119, -0.014211, -0.012385, -0.009405, -0.005717, -0.001200, 0.005598, 0.012322, 0.019802, 0.027634, 0.036065, 0.043060, 0.049581, 0.053907, 0.058379, 0.059887, 0.062501, 0.064828, 0.060983, 0.059305, 0.053841
#*# 	  -0.008528, -0.011211, -0.015934, -0.017470, -0.018359, -0.015987, -0.015108, -0.011749, -0.008348, -0.004160, 0.001491, 0.010490, 0.017637, 0.023366, 0.030990, 0.039099, 0.044584, 0.050832, 0.055791, 0.058214, 0.059780, 0.054257, 0.050910, 0.047824, 0.048400
#*# 	  -0.005285, -0.013149, -0.018219, -0.020419, -0.021473, -0.019101, -0.019287, -0.015092, -0.012224, -0.007967, -0.002043, 0.004402, 0.011974, 0.018705, 0.025697, 0.032964, 0.040467, 0.045384, 0.048003, 0.049648, 0.048339, 0.045896, 0.043613, 0.043872, 0.044286
#*# 	  -0.006761, -0.014829, -0.018831, -0.020996, -0.021761, -0.023204, -0.021666, -0.019635, -0.015766, -0.011309, -0.007020, 0.000774, 0.005977, 0.013830, 0.021955, 0.029426, 0.035682, 0.039487, 0.040596, 0.040748, 0.039452, 0.039075, 0.039499, 0.041289, 0.040773
#*# 	  -0.006472, -0.011886, -0.015680, -0.020416, -0.022898, -0.025910, -0.024157, -0.022432, -0.019100, -0.015465, -0.009853, -0.003066, 0.003778, 0.010766, 0.017668, 0.023415, 0.028485, 0.031878, 0.033760, 0.037432, 0.036718, 0.035669, 0.032813, 0.029557, 0.029243
#*# 	  0.000646, -0.005690, -0.012710, -0.018309, -0.021853, -0.023837, -0.025319, -0.023065, -0.019740, -0.016347, -0.011995, -0.005517, 0.001254, 0.008498, 0.015045, 0.021093, 0.025184, 0.027965, 0.028682, 0.031470, 0.034048, 0.032072, 0.028659, 0.027120, 0.030234
#*# x_count = 25
#*# y_count = 25
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.2
#*# min_x = 30.0
#*# max_x = 205.0
#*# min_y = 30.0
#*# max_y = 210.0
#*#
#*# [skew_correction Califlower]
#*# xy_skew = -0.00040044160245974287
#*# xz_skew = 0.0
#*# yz_skew = 0.0
#*#
#*# [chamber]
#*# pid_version = 1
#*# pid_target = 60.00
#*# pid_tolerance = 0.0200
#*# control = pid
#*# pid_kp = 66.562
#*# pid_ki = 1.024
#*# pid_kd = 1081.212
