[save_variables]
filename: ~/printer_data/config/variables.txt
[respond]
[include chopper_tune.cfg]
[skew_correction]
[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_02002A000151313433343333-if00

[printer]
kinematics: corexy
max_velocity: 500
max_accel: 20000
max_z_velocity: 75
max_z_accel: 2000
square_corner_velocity: 8
minimum_cruise_ratio: 0

[force_move]
enable_force_move: True

[gcode_arcs]
resolution: 0.1

[idle_timeout]
timeout: 3600
gcode:
    TURN_OFF_HEATERS
    M84
    LIGHTS_OFF
    M107

[include ./motors.cfg]
[include ./beacon.cfg]

#####################################################################
#   Extruder
#####################################################################

# MOTOR_3, HE3, T3
[extruder]
step_pin: PE6
dir_pin: PA14
enable_pin: !PE0
rotation_distance: 3.99
microsteps: 16
full_steps_per_rotation: 200
nozzle_diameter: 0.400
filament_diameter: 1.75
heater_pin: PB11
sensor_type: PT1000
sensor_pin: PF7
pullup_resistor: 4700
min_temp: 10
max_temp: 350
max_power: 1.0
max_extrude_only_distance: 1400.0
max_extrude_only_velocity: 75.0
max_extrude_only_accel: 1500
max_extrude_cross_section: 5
min_extrude_temp: 10
pressure_advance: 0.015
pressure_advance_smooth_time: 0.02
pwm_cycle_time: 0.010

#heater_power: 120
#cooling_fan: fan
#ambient_temp_sensor: temperature_sensor beacon_coil
#filament_density: 1.20
#filament_heat_capacity: 1.8

[tmc2209 extruder]
uart_pin: PD3
interpolate: false
run_current: 0.45
sense_resistor: 0.110
stealthchop_threshold: 0

[verify_heater extruder]
hysteresis: 10
check_gain_time: 40
heating_gain: 2
max_error: 500

#####################################################################
#   Bed Heater
#####################################################################

#  HE2, T2
[heater_bed]
heater_pin: PB0
sensor_type: Generic 3950
sensor_pin: PF6
max_power: 1.0
min_temp: 0
max_temp: 120
pwm_cycle_time: 0.01667

#####################################################################
#   Chamber Heater
#####################################################################

#  HE2, T1, MAX31865

[heater_generic chamber]
sensor_type: PT1000
sensor_pin: PF3

min_temp: 0
max_temp: 350

gcode_id: C
heater_pin: PA0

control: pid
pid_Kp: 70.184
pid_Ki: 0.376
pid_Kd: 3274.071

[verify_heater chamber]
max_error: 500 # double if needed
check_gain_time: 600 #default for extruder is 20, 60 for bed heater. increase for weak heaters. 
hysteresis: 15 #default is 5, this is the maximum allowable deviation from setpoint. increase during PID tuning. 
heating_gain:2 #default is 2. increase this for very fast heaters, decrease this for weak ones.

#  T1
[temperature_sensor heater_core]
sensor_pin: PF5
sensor_type: PT1000

#####################################################################
#   Fan Control
#####################################################################

# FAN4
[fan]
pin: !PD14
kick_start_time: 0.25
cycle_time: 0.15
off_below: 0.10
shutdown_speed: 0.0
cycle_time: 0.00004
hardware_pwm: false

# FAN5
#[heater_fan hotend_fan]
#pin: PD15
#max_power: 1.0
#kick_start_time: 0.5
#heater: extruder
#heater_temp: 50.0
#shutdown_speed: 1.0

# FAN3
[heater_fan bed_fan]
pin: PD13
max_power: 1.0
kick_start_time: 0.5
heater: heater_bed
heater_temp: 110.0
shutdown_speed: 0.0

# FAN2
[controller_fan controller_fan]
pin: PD12
max_power: 1.0
fan_speed: 1.0
kick_start_time: 0.1
heater: extruder,heater_bed
shutdown_speed: 1.0
hardware_pwm: false

# FAN1
[heater_fan chamber_fan]
pin: PE5
max_power: 1.0
kick_start_time: 0.5
heater: chamber
heater_temp: 50.0
shutdown_speed: 1.0
tachometer_pin: PG15
tachometer_ppr: 1
tachometer_poll_interval: 0.0015

#####################################################################
#   LED Control
#####################################################################

# HE1
[output_pin chamber_light]
pin: PA3
pwm: true
shutdown_value: 0
value: 0.0
hardware_pwm: false
cycle_time: 0.0005

[include ./input_shaper.cfg]
[include ./fluidd.cfg]
[include ./macros/macros.cfg]
[include KAMP_Settings.cfg]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# block_heat_capacity = 30.7120
#*# sensor_responsiveness = 0.102444
#*# ambient_transfer = 0.146235
#*# fan_ambient_transfer = 0.146235, 0.222049, 0.295032
#*# pid_version = 1
#*# pid_target = 280.00
#*# pid_tolerance = 0.0200
#*# pid_kp = 12.726
#*# pid_ki = 0.590
#*# pid_kd = 68.639
#*#
#*# [heater_bed]
#*# control = pid
#*# block_heat_capacity = 913.098
#*# sensor_responsiveness = 0.0169211
#*# ambient_transfer = 6.86391
#*# fan_ambient_transfer =
#*# pid_version = 1
#*# pid_target = 110.00
#*# pid_tolerance = 0.0200
#*# pid_kp = 53.495
#*# pid_ki = 2.048
#*# pid_kd = 349.390
#*#
#*# [beacon model default]
#*# model_coef = 1.4262141491390063,
#*# 	  1.7725581547530895,
#*# 	  0.8072583215682039,
#*# 	  0.3099722775563886,
#*# 	  0.24087873526531825,
#*# 	  0.4430437011157934,
#*# 	  -0.0687216228917717,
#*# 	  -0.38311197522275814,
#*# 	  0.19572487148758788,
#*# 	  0.26183616582656666
#*# model_domain = 1.8106913241023306e-07,1.9047012172922702e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 60.027617
#*# model_offset = 0.00000
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.124445, 0.120241, 0.117495, 0.113222, 0.109605, 0.107267, 0.106519, 0.106605, 0.106872, 0.107043, 0.107630, 0.107861, 0.106822, 0.106648, 0.104891, 0.101536, 0.098077, 0.093529, 0.087904, 0.083270, 0.077068, 0.071565, 0.066067, 0.061632, 0.055262
#*# 	  0.117680, 0.114012, 0.110522, 0.106501, 0.103952, 0.100946, 0.100373, 0.100026, 0.101183, 0.101636, 0.102103, 0.102010, 0.102265, 0.101516, 0.100664, 0.097092, 0.093234, 0.089948, 0.086708, 0.081999, 0.075785, 0.069588, 0.062778, 0.057830, 0.053867
#*# 	  0.110714, 0.106309, 0.103407, 0.100213, 0.097744, 0.095974, 0.093889, 0.094650, 0.094575, 0.095412, 0.096611, 0.097498, 0.097325, 0.096350, 0.095613, 0.093303, 0.090761, 0.086924, 0.083633, 0.079002, 0.071994, 0.065229, 0.058943, 0.054864, 0.051587
#*# 	  0.104171, 0.099830, 0.097211, 0.093389, 0.090823, 0.089227, 0.088822, 0.088362, 0.089233, 0.089483, 0.090822, 0.091966, 0.092196, 0.092261, 0.092203, 0.090051, 0.086730, 0.084213, 0.078626, 0.074454, 0.069223, 0.062396, 0.057221, 0.053117, 0.050235
#*# 	  0.099349, 0.095343, 0.092872, 0.088357, 0.086038, 0.084307, 0.084806, 0.084101, 0.085016, 0.086006, 0.087074, 0.087592, 0.088171, 0.088013, 0.087720, 0.085196, 0.083945, 0.080412, 0.077068, 0.072746, 0.067606, 0.061101, 0.055673, 0.051347, 0.046185
#*# 	  0.094804, 0.089884, 0.088053, 0.083943, 0.082492, 0.081038, 0.080998, 0.080191, 0.080783, 0.081154, 0.081682, 0.083301, 0.083485, 0.083976, 0.083832, 0.081502, 0.079041, 0.076471, 0.073194, 0.070082, 0.065120, 0.059346, 0.053410, 0.048050, 0.044321
#*# 	  0.089267, 0.085536, 0.083847, 0.080980, 0.079361, 0.077401, 0.076472, 0.075178, 0.075939, 0.077148, 0.078300, 0.079375, 0.078866, 0.079197, 0.078777, 0.077271, 0.075106, 0.073854, 0.070910, 0.066230, 0.060418, 0.055183, 0.049811, 0.045910, 0.044780
#*# 	  0.086027, 0.081642, 0.080431, 0.077729, 0.076591, 0.074036, 0.073698, 0.072517, 0.073032, 0.073380, 0.074797, 0.074644, 0.074648, 0.074755, 0.074180, 0.072374, 0.071384, 0.069630, 0.066420, 0.062763, 0.058562, 0.051893, 0.047022, 0.044254, 0.041885
#*# 	  0.083672, 0.080341, 0.077386, 0.074666, 0.071999, 0.071752, 0.070712, 0.070329, 0.070271, 0.069682, 0.070137, 0.071569, 0.071104, 0.070242, 0.070162, 0.068418, 0.066142, 0.064347, 0.061473, 0.059598, 0.056904, 0.052107, 0.046507, 0.041862, 0.038004
#*# 	  0.081305, 0.077780, 0.076091, 0.072086, 0.070429, 0.068434, 0.069161, 0.067535, 0.067780, 0.067806, 0.067757, 0.068011, 0.068224, 0.067297, 0.066672, 0.064336, 0.062665, 0.060766, 0.059020, 0.056662, 0.053944, 0.050056, 0.045240, 0.041408, 0.035128
#*# 	  0.078601, 0.075784, 0.073811, 0.071323, 0.068017, 0.066606, 0.065557, 0.064647, 0.064380, 0.064912, 0.065244, 0.064821, 0.064609, 0.064233, 0.064304, 0.062389, 0.060847, 0.059525, 0.057901, 0.054397, 0.050768, 0.046157, 0.041220, 0.038209, 0.036200
#*# 	  0.077267, 0.074409, 0.071564, 0.069026, 0.065705, 0.063712, 0.063084, 0.062644, 0.062787, 0.062798, 0.062668, 0.062836, 0.062241, 0.061576, 0.061665, 0.060130, 0.058804, 0.058049, 0.055182, 0.052232, 0.048861, 0.044331, 0.040575, 0.039236, 0.035698
#*# 	  0.074708, 0.070188, 0.067165, 0.064741, 0.063650, 0.061995, 0.061575, 0.061145, 0.060099, 0.059197, 0.059149, 0.058536, 0.060392, 0.059476, 0.059551, 0.058238, 0.056773, 0.054298, 0.053064, 0.050926, 0.048302, 0.044126, 0.039412, 0.035498, 0.031413
#*# 	  0.071151, 0.067391, 0.065925, 0.063412, 0.061645, 0.059246, 0.058467, 0.057274, 0.057347, 0.057066, 0.056751, 0.057140, 0.056755, 0.057114, 0.056639, 0.055770, 0.054787, 0.053793, 0.051903, 0.048953, 0.046535, 0.040966, 0.036506, 0.032741, 0.028820
#*# 	  0.066913, 0.066293, 0.062867, 0.060893, 0.058898, 0.055992, 0.055768, 0.055083, 0.055314, 0.054353, 0.055043, 0.054495, 0.054535, 0.054214, 0.054280, 0.053525, 0.052906, 0.051210, 0.048943, 0.046801, 0.042699, 0.038268, 0.033518, 0.030260, 0.025967
#*# 	  0.064803, 0.061974, 0.058877, 0.055684, 0.053914, 0.053257, 0.053902, 0.052684, 0.053734, 0.051992, 0.051837, 0.051184, 0.051720, 0.051691, 0.051363, 0.050408, 0.049216, 0.047662, 0.046420, 0.043852, 0.040841, 0.034288, 0.029184, 0.024218, 0.019899
#*# 	  0.060904, 0.057461, 0.054940, 0.051965, 0.050729, 0.049689, 0.049667, 0.049145, 0.049599, 0.048430, 0.048518, 0.048418, 0.048512, 0.047914, 0.046651, 0.045938, 0.045213, 0.045161, 0.043648, 0.040170, 0.035378, 0.029554, 0.023351, 0.017954, 0.015352
#*# 	  0.054543, 0.052958, 0.051256, 0.048606, 0.047195, 0.045503, 0.045128, 0.043980, 0.044831, 0.044125, 0.044080, 0.043873, 0.044006, 0.044085, 0.044423, 0.043773, 0.042240, 0.040884, 0.038239, 0.033179, 0.029909, 0.022721, 0.018340, 0.015031, 0.009956
#*# 	  0.051520, 0.047653, 0.045912, 0.043649, 0.041706, 0.041040, 0.040072, 0.039525, 0.039439, 0.039725, 0.038642, 0.038723, 0.038330, 0.039019, 0.038928, 0.038215, 0.036705, 0.035352, 0.033060, 0.029262, 0.024642, 0.018419, 0.010580, 0.005171, 0.000983
#*# 	  0.046275, 0.044700, 0.042314, 0.040088, 0.037456, 0.035810, 0.034134, 0.034243, 0.033380, 0.032948, 0.033401, 0.034200, 0.032965, 0.033758, 0.032610, 0.031683, 0.030337, 0.028888, 0.025662, 0.022130, 0.018224, 0.010467, 0.003684, -0.002047, -0.006428
#*# 	  0.040742, 0.038362, 0.037090, 0.035085, 0.033211, 0.031072, 0.029587, 0.028031, 0.027488, 0.026460, 0.026853, 0.027113, 0.026924, 0.027403, 0.026136, 0.025040, 0.024476, 0.023218, 0.020263, 0.015946, 0.009954, 0.002370, -0.006024, -0.010926, -0.014089
#*# 	  0.037259, 0.033920, 0.031715, 0.030021, 0.027239, 0.025066, 0.023329, 0.021532, 0.021046, 0.020705, 0.020290, 0.020594, 0.020422, 0.020600, 0.019137, 0.018582, 0.017614, 0.015356, 0.011409, 0.006897, 0.001013, -0.005580, -0.012577, -0.017977, -0.022637
#*# 	  0.032351, 0.030497, 0.027745, 0.025255, 0.021945, 0.018099, 0.016190, 0.014820, 0.014361, 0.013608, 0.013960, 0.013139, 0.013062, 0.013469, 0.012416, 0.012129, 0.010170, 0.008128, 0.003633, -0.000787, -0.006386, -0.013134, -0.021204, -0.026305, -0.029727
#*# 	  0.028582, 0.025051, 0.021814, 0.018484, 0.016014, 0.012832, 0.011124, 0.009470, 0.009062, 0.007771, 0.007541, 0.007783, 0.006594, 0.006323, 0.005436, 0.004761, 0.002862, 0.001217, -0.002437, -0.008245, -0.014138, -0.021711, -0.027789, -0.032831, -0.035849
#*# 	  0.026418, 0.022718, 0.018619, 0.014987, 0.011126, 0.007948, 0.006097, 0.004778, 0.003870, 0.002102, 0.002140, 0.001680, 0.001186, 0.001219, 0.000087, -0.000781, -0.002231, -0.006404, -0.011062, -0.016226, -0.020914, -0.027162, -0.032585, -0.037426, -0.042874
#*# x_count = 25
#*# y_count = 25
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.2
#*# min_x = 30.0
#*# max_x = 205.0
#*# min_y = 30.0
#*# max_y = 210.0
#*#
#*# [skew_correction Califlower]
#*# xy_skew = -0.00040044160245974287
#*# xz_skew = 0.0
#*# yz_skew = 0.0
#*#
#*# [chamber]
#*# pid_version = 1
#*# pid_target = 60.00
#*# pid_tolerance = 0.0200
#*# control = pid
#*# pid_kp = 66.562
#*# pid_ki = 1.024
#*# pid_kd = 1081.212
