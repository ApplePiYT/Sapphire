[save_variables]
filename: ~/printer_data/config/variables.txt
[respond]
[include chopper_tune.cfg]
[skew_correction]
[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_02002A000151313433343333-if00

[printer]
kinematics: corexy
max_velocity: 500
max_accel: 20000
max_z_velocity: 75
max_z_accel: 2000
square_corner_velocity: 8
minimum_cruise_ratio: 0

[force_move]
enable_force_move: True

[gcode_arcs]
resolution: 0.1

[idle_timeout]
timeout: 3600
gcode:
    TURN_OFF_HEATERS
    M84
    LIGHTS_OFF
    M107

[include ./motors.cfg]
[include ./beacon.cfg]

#####################################################################
#   Extruder
#####################################################################

# MOTOR_3, HE3, T3
[extruder]
step_pin: PE6
dir_pin: PA14
enable_pin: !PE0
rotation_distance: 3.99
microsteps: 16
full_steps_per_rotation: 200
nozzle_diameter: 0.400
filament_diameter: 1.75
heater_pin: PB11
sensor_type: PT1000
sensor_pin: PF7
pullup_resistor: 4700
min_temp: 10
max_temp: 350
max_power: 1.0
max_extrude_only_distance: 1400.0
max_extrude_only_velocity: 75.0
max_extrude_only_accel: 1500
max_extrude_cross_section: 5
min_extrude_temp: 10
pressure_advance: 0.015
pressure_advance_smooth_time: 0.02
pwm_cycle_time: 0.010

#heater_power: 120
#cooling_fan: fan
#ambient_temp_sensor: temperature_sensor beacon_coil
#filament_density: 1.20
#filament_heat_capacity: 1.8

[tmc2209 extruder]
uart_pin: PD3
interpolate: false
run_current: 0.6
sense_resistor: 0.110
stealthchop_threshold: 0
driver_TBL: 0
driver_TOFF: 3
driver_HSTRT: 7
driver_HEND: 5

[verify_heater extruder]
hysteresis: 10
check_gain_time: 40
heating_gain: 2
max_error: 500

#####################################################################
#   Bed Heater
#####################################################################

#  HE2, T2
[heater_bed]
heater_pin: PB0
sensor_type: Generic 3950
sensor_pin: PF6
max_power: 1.0
min_temp: 0
max_temp: 120
pwm_cycle_time: 0.01667

#####################################################################
#   Chamber Heater
#####################################################################

#  HE2, T1, MAX31865

[heater_generic chamber]
sensor_type: PT1000
sensor_pin: PF3

min_temp: 0
max_temp: 350

gcode_id: C
heater_pin: PA0

control: pid
pid_Kp: 70.184
pid_Ki: 0.376
pid_Kd: 3274.071

[verify_heater chamber]
max_error: 500 # double if needed
check_gain_time: 600 #default for extruder is 20, 60 for bed heater. increase for weak heaters. 
hysteresis: 15 #default is 5, this is the maximum allowable deviation from setpoint. increase during PID tuning. 
heating_gain:2 #default is 2. increase this for very fast heaters, decrease this for weak ones.

#  T1
[temperature_sensor heater_core]
sensor_pin: PF5
sensor_type: PT1000

#####################################################################
#   Fan Control
#####################################################################

# FAN4
[fan]
pin: !PD14
kick_start_time: 0.25
cycle_time: 0.15
off_below: 0.10
shutdown_speed: 0.0
hardware_pwm: false

# FAN5
#[heater_fan hotend_fan]
#pin: PD15
#max_power: 1.0
#kick_start_time: 0.5
#heater: extruder
#heater_temp: 50.0
#shutdown_speed: 1.0

# FAN3
[heater_fan bed_fan]
pin: PD13
max_power: 1.0
kick_start_time: 0.5
heater: heater_bed
heater_temp: 110.0
shutdown_speed: 0.0

# FAN2
[controller_fan controller_fan]
pin: PD12
max_power: 1.0
fan_speed: 1.0
kick_start_time: 0.1
heater: extruder,heater_bed
shutdown_speed: 1.0
cycle_time: 0.00004
hardware_pwm: True

# FAN1
[heater_fan chamber_fan]
pin: PE5
max_power: 1.0
kick_start_time: 0.5
heater: chamber
heater_temp: 50.0
shutdown_speed: 1.0
tachometer_pin: PG15
tachometer_ppr: 1
tachometer_poll_interval: 0.0015

#####################################################################
#   LED Control
#####################################################################

# HE1
[output_pin chamber_light]
pin: PA3
pwm: true
shutdown_value: 0
value: 0.0
hardware_pwm: false
cycle_time: 0.0005

[include ./input_shaper.cfg]
[include ./fluidd.cfg]
[include ./macros/macros.cfg]
[include KAMP_Settings.cfg]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# block_heat_capacity = 30.7120
#*# sensor_responsiveness = 0.102444
#*# ambient_transfer = 0.146235
#*# fan_ambient_transfer = 0.146235, 0.222049, 0.295032
#*# pid_version = 1
#*# pid_target = 280.00
#*# pid_tolerance = 0.0200
#*# pid_kp = 12.726
#*# pid_ki = 0.590
#*# pid_kd = 68.639
#*#
#*# [heater_bed]
#*# control = pid
#*# block_heat_capacity = 913.098
#*# sensor_responsiveness = 0.0169211
#*# ambient_transfer = 6.86391
#*# fan_ambient_transfer =
#*# pid_version = 1
#*# pid_target = 110.00
#*# pid_tolerance = 0.0200
#*# pid_kp = 53.495
#*# pid_ki = 2.048
#*# pid_kd = 349.390
#*#
#*# [beacon model default]
#*# model_coef = 1.4716949649366866,
#*# 	1.8166720492096156,
#*# 	0.7595622127127389,
#*# 	0.2540382392010495,
#*# 	0.3340748117256274,
#*# 	0.5773516000809598,
#*# 	-0.1813089907931199,
#*# 	-0.587253199240883,
#*# 	0.21616520788359495,
#*# 	0.3412897013783214
#*# model_domain = 1.8330825474745873e-07,1.9312089594602364e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 83.064142
#*# model_offset = 0.00000
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.099138, 0.091162, 0.086963, 0.087292, 0.086831, 0.084440, 0.085902, 0.086217, 0.086338, 0.089415, 0.091264, 0.094094, 0.097249, 0.096091, 0.096889, 0.095985, 0.096207, 0.093386, 0.090562, 0.085774, 0.085081, 0.079814, 0.077069, 0.074702, 0.073802
#*# 	  0.089080, 0.085581, 0.082114, 0.078840, 0.078539, 0.078441, 0.079882, 0.078240, 0.081250, 0.083204, 0.084988, 0.090863, 0.090983, 0.092095, 0.092040, 0.093075, 0.090748, 0.091752, 0.085739, 0.084709, 0.082725, 0.078436, 0.074275, 0.072377, 0.069847
#*# 	  0.084812, 0.079047, 0.076177, 0.074158, 0.072863, 0.071907, 0.072432, 0.072633, 0.074950, 0.079472, 0.081120, 0.085938, 0.086443, 0.088241, 0.087780, 0.088838, 0.087951, 0.087022, 0.083953, 0.081255, 0.079501, 0.076168, 0.072253, 0.070368, 0.067658
#*# 	  0.076328, 0.072172, 0.069789, 0.068183, 0.066623, 0.065496, 0.068835, 0.066783, 0.068823, 0.073413, 0.076138, 0.080072, 0.080681, 0.083331, 0.083576, 0.086501, 0.083876, 0.084073, 0.081136, 0.078453, 0.076211, 0.073200, 0.069149, 0.067297, 0.066152
#*# 	  0.072215, 0.068227, 0.064398, 0.062241, 0.061449, 0.060875, 0.062462, 0.063369, 0.065471, 0.068567, 0.072662, 0.073364, 0.076685, 0.075545, 0.080623, 0.080677, 0.079994, 0.081322, 0.077539, 0.076530, 0.072322, 0.070561, 0.064632, 0.065154, 0.062953
#*# 	  0.067120, 0.063632, 0.061207, 0.057281, 0.058689, 0.055723, 0.058985, 0.057238, 0.060126, 0.063602, 0.065235, 0.070693, 0.070793, 0.074033, 0.075051, 0.077872, 0.076186, 0.076332, 0.073476, 0.071128, 0.071055, 0.066055, 0.063745, 0.062005, 0.060763
#*# 	  0.065069, 0.058359, 0.057561, 0.053623, 0.054104, 0.052920, 0.055731, 0.054092, 0.057692, 0.058829, 0.063193, 0.067226, 0.066620, 0.068737, 0.070071, 0.072643, 0.071433, 0.073410, 0.070240, 0.068477, 0.067543, 0.065081, 0.060092, 0.060762, 0.059196
#*# 	  0.058681, 0.054738, 0.053106, 0.050507, 0.050120, 0.050882, 0.051869, 0.051609, 0.054422, 0.055106, 0.058889, 0.063379, 0.063367, 0.065620, 0.066782, 0.068731, 0.067223, 0.069465, 0.067353, 0.065990, 0.065569, 0.063384, 0.059034, 0.059407, 0.057937
#*# 	  0.057923, 0.051891, 0.050156, 0.047070, 0.047399, 0.047878, 0.049683, 0.048510, 0.050885, 0.053569, 0.055257, 0.061651, 0.058679, 0.060805, 0.063831, 0.063112, 0.065352, 0.064394, 0.064468, 0.062303, 0.063471, 0.060175, 0.057729, 0.057929, 0.056318
#*# 	  0.052982, 0.050582, 0.045313, 0.045837, 0.045402, 0.045330, 0.047030, 0.047162, 0.046953, 0.049886, 0.054889, 0.054659, 0.057435, 0.058463, 0.059863, 0.063135, 0.060874, 0.062405, 0.061467, 0.061757, 0.060687, 0.059423, 0.056836, 0.055788, 0.054410
#*# 	  0.051248, 0.049435, 0.044298, 0.043676, 0.044225, 0.042566, 0.045247, 0.044215, 0.044837, 0.046598, 0.052823, 0.054246, 0.054510, 0.057369, 0.057745, 0.059364, 0.058312, 0.060932, 0.058233, 0.060568, 0.059269, 0.055915, 0.056101, 0.053108, 0.052278
#*# 	  0.048740, 0.046321, 0.042757, 0.041330, 0.041363, 0.041807, 0.042277, 0.043435, 0.044472, 0.045613, 0.048229, 0.052873, 0.054127, 0.054718, 0.058019, 0.056822, 0.059789, 0.058668, 0.058262, 0.058152, 0.057984, 0.057196, 0.053281, 0.054890, 0.051730
#*# 	  0.046335, 0.042290, 0.041533, 0.040355, 0.038149, 0.041927, 0.039558, 0.042010, 0.041429, 0.045692, 0.046002, 0.051901, 0.052393, 0.053414, 0.056857, 0.055668, 0.058175, 0.059105, 0.057324, 0.058251, 0.056781, 0.056137, 0.052805, 0.053403, 0.050323
#*# 	  0.042623, 0.042896, 0.039687, 0.037109, 0.039696, 0.037765, 0.040086, 0.039898, 0.040751, 0.041882, 0.047134, 0.047784, 0.049641, 0.054294, 0.052676, 0.058452, 0.056234, 0.059901, 0.055974, 0.058345, 0.056049, 0.053947, 0.052949, 0.050919, 0.048468
#*# 	  0.042644, 0.037755, 0.037084, 0.036482, 0.036517, 0.038062, 0.038637, 0.038564, 0.037793, 0.041061, 0.043396, 0.045799, 0.047919, 0.049477, 0.053530, 0.052832, 0.054805, 0.056145, 0.055352, 0.055992, 0.052605, 0.052279, 0.047323, 0.047512, 0.044831
#*# 	  0.039007, 0.035708, 0.035890, 0.033815, 0.035947, 0.035021, 0.037266, 0.036968, 0.037460, 0.038695, 0.039787, 0.045502, 0.044913, 0.049002, 0.048275, 0.050936, 0.052733, 0.053651, 0.053577, 0.050897, 0.052543, 0.046514, 0.046232, 0.041934, 0.041008
#*# 	  0.036630, 0.034077, 0.031683, 0.030139, 0.033850, 0.033684, 0.032886, 0.036143, 0.034539, 0.035181, 0.040010, 0.042132, 0.042422, 0.044416, 0.046618, 0.047182, 0.049014, 0.053665, 0.049410, 0.050401, 0.047950, 0.042188, 0.040331, 0.036601, 0.034453
#*# 	  0.033314, 0.028742, 0.029014, 0.027751, 0.028248, 0.030593, 0.032641, 0.031876, 0.031286, 0.034273, 0.034565, 0.040730, 0.041019, 0.041693, 0.044009, 0.044330, 0.047310, 0.047754, 0.047746, 0.044235, 0.042913, 0.040909, 0.033451, 0.032570, 0.029424
#*# 	  0.028887, 0.027724, 0.025163, 0.023808, 0.025459, 0.027434, 0.026002, 0.029304, 0.027921, 0.028114, 0.033411, 0.035637, 0.033982, 0.038847, 0.038445, 0.040304, 0.042832, 0.045052, 0.042346, 0.042441, 0.038947, 0.031520, 0.030098, 0.026008, 0.021829
#*# 	  0.025524, 0.021370, 0.019788, 0.020391, 0.020971, 0.020694, 0.024846, 0.022554, 0.021913, 0.025811, 0.026997, 0.029693, 0.031238, 0.033776, 0.034318, 0.038017, 0.038418, 0.038224, 0.039208, 0.035100, 0.032494, 0.027524, 0.022919, 0.019016, 0.015852
#*# 	  0.022682, 0.019600, 0.016004, 0.017801, 0.018658, 0.015543, 0.019368, 0.018952, 0.019806, 0.020891, 0.021986, 0.026588, 0.026321, 0.029030, 0.030564, 0.032080, 0.033713, 0.033290, 0.033373, 0.029596, 0.025885, 0.021938, 0.016670, 0.012313, 0.010074
#*# 	  0.019547, 0.014022, 0.012269, 0.012319, 0.012655, 0.010878, 0.014172, 0.012842, 0.012674, 0.016244, 0.017906, 0.019465, 0.024005, 0.021564, 0.026218, 0.029446, 0.025607, 0.027647, 0.026878, 0.021862, 0.019137, 0.016339, 0.010206, 0.005717, 0.003448
#*# 	  0.016129, 0.011946, 0.008775, 0.009263, 0.007667, 0.006100, 0.008659, 0.008637, 0.010077, 0.012107, 0.013205, 0.015650, 0.017546, 0.018147, 0.020470, 0.023334, 0.023717, 0.022938, 0.020386, 0.016663, 0.013147, 0.007407, 0.004418, 0.002073, -0.001661
#*# 	  0.013089, 0.008962, 0.006219, 0.004155, 0.003660, 0.004372, 0.003014, 0.005819, 0.004934, 0.006164, 0.010315, 0.012045, 0.013224, 0.015610, 0.017966, 0.018086, 0.019428, 0.017940, 0.015014, 0.011470, 0.009077, 0.004116, 0.000018, -0.002234, -0.005129
#*# 	  0.011999, 0.006936, 0.003693, 0.002515, 0.000167, 0.001580, 0.000328, 0.001378, 0.001916, 0.003398, 0.005085, 0.008363, 0.010899, 0.010306, 0.012922, 0.015152, 0.013098, 0.012982, 0.011074, 0.006426, 0.004912, -0.000313, -0.005275, -0.007853, -0.007665
#*# x_count = 25
#*# y_count = 25
#*# mesh_x_pps = 0
#*# mesh_y_pps = 0
#*# algo = direct
#*# tension = 0.2
#*# min_x = 30.0
#*# max_x = 205.0
#*# min_y = 30.0
#*# max_y = 210.0
#*#
#*# [skew_correction Califlower]
#*# xy_skew = -0.00040044160245974287
#*# xz_skew = 0.0
#*# yz_skew = 0.0
#*#
#*# [chamber]
#*# pid_version = 1
#*# pid_target = 60.00
#*# pid_tolerance = 0.0200
#*# control = pid
#*# pid_kp = 66.562
#*# pid_ki = 1.024
#*# pid_kd = 1081.212
